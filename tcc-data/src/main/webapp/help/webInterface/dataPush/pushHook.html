<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>TCC开放接口帮助中心</title>
    <meta name="keywords" content="接口支持">
    <meta name="description" content="天润融通为客户提供服务型呼叫中心系统、外呼型呼叫中心系统、分布 式呼叫中心系统、智能语音云平台,是呼叫中心（call center）行业的创新者.为百度、大众点评等众多客户提 供呼叫中心解决方案.">
    <link href="/framework/stylesheet/helpcenter/commonstyle.css" type="text/css" rel="stylesheet" />
    <link href="/framework/stylesheet/helpcenter/homestyle.css" type="text/css" rel="stylesheet" />
    <link href="/framework/stylesheet/helpcenter/substyle.css" type="text/css" rel="stylesheet" />
    <script src="/framework/scripts/jquery-1.11.1.js" type="text/javascript"></script>
    <script src="/framework/scripts/helpcenter/interface.js" type="text/javascript"></script>
    <script src="/framework/scripts/helpcenter/webjs.js" type="text/javascript"></script>
    <script>
        /* 当前展开 */
        window.onload = function ()
        {
            $(".jklist ul li ul li#17").parent("ul").parent("li").children("span").removeClass("open").addClass("close");
            $(".jklist ul li ul li#17").parent("ul").css("display","block");
            $(".jklist ul li ul li#17 a").addClass("cure");
        }
    </script>
</head>
<body>

<div class="topbody"></div>

<div class="mainbody">
    <div class="body-l">
        <div id="jklist" class="jklist">
        </div>

    </div>
<div class="body-r">
    <h1>挂机推送</h1>
     
    <div class="conbar">
      <h1>接口功能概述</h1>
      <div class="concon grey">挂机推送位于通话流程的最后一步，是企业获取通话记录的主要方式之一。指的是在通话结束后，以挂机动作为触发点，由云平台向企业提供的web接口地址推送该通话的信息，以便企业掌握业务情况。<br />
&nbsp;<img alt="" src="/framework/images/helpcenter/20151012102808411.png" style="width: 583px; height: 65px;" /><br />
</div>
    </div>
     
    <div class="conbar">
      <h1>挂机推送内容</h1>
      <div class="concon grey">1.通话发起、接通、挂断过程中产生的原始数据<br />
2.流程中获取的用户按键、交互的返回数据等<br />
3.其他用户自行定义的数据。<br />
如下图所示，蓝字部分为流程中可能获得的参数。参数解释详见接口说明。<br />
<img alt="" src="/framework/images/helpcenter/20151012103201790.png" style="width: 498px; height: 592px;" /><br />
</div>
    </div>
     
    <div class="conbar">
      <h1>注意事项</h1>
      <div class="concon grey">挂机推送的地址及参数设置是针对整个账号的。每一通电话都会有相应推送，不对不同的语音流程进行区分。因此，如果在同一个账号下有不同流程，应注意合理设置参数以符合所有流程的推送要求。<br />
</div>
    </div>
     
    <div class="conbar">
      <h1>对接步骤</h1>
      <div class="concon grey">1.企业整理需要的通话数据参数名称和描述；<br />
2.提交给云平台技术人员评估参数需求并进行适当调整；<br />
3.企业开发接收数据的接口提交云平台技术人员<br />
4.配置后，双方一同测试接口有效性；<br />
5.正式上线</div>
    </div>
     
    <div class="conbar">
      <h1>接口说明</h1>
      <div class="concon grey">发起者：天润融通云平台<br />
接受者：企业<br />
接口类型：HTTP请求<br />
推送方式：POST<br />
接口地址：企业自定<br />
接口返回值：JSON格式返回结果<br />
&nbsp;<br />
企业可获得的参数：<br />
1.系统变量<br />
2.被叫用户输入数据<br />
3.调用呼叫接口时传入的自定义数据<br />
4.语音流程中定义或通过简单计算获得的数据<br />
部分可获得变量见下表。<br />
企业整理所需数据内容及参数名（可自行设定或参考系统变量名）提交技术人员，并使用相应接口进行接收。<br />
&nbsp;<br />
可用系统变量列表：<br />
<table border="0" cellpadding="0" cellspacing="0" width="426">
<tbody>
	<tr>
	<td style="width:171px;"><strong>变量名</strong></td>
	<td style="width:132px;"><strong>描述</strong></td>
	<td style="width:265px;"><strong>备注</strong></td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_main_unique_id</td>
	<td style="width:132px;">通话记录唯一标识</td>
	<td style="width:265px;">一通呼叫的唯一标识；如：ccic2_202-1367040082.6</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_enterprise_id</td>
	<td style="width:132px;">企业Id</td>
	<td style="width:265px;">企业号，7位数字；如：3000290</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_customer_number</td>
	<td style="width:132px;">客户号码</td>
	<td style="width:265px;">客户的号码；如：01087128906</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_customer_area_code</td>
	<td style="width:132px;">呼入或外呼座席接听后的座席区号</td>
	<td style="width:265px;">3位或4位电话区号；如：010</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_customer_number_type</td>
	<td style="width:132px;">来电或外呼客户号码类型: 手机/固话</td>
	<td style="width:265px;">客户号码类型，其值为1或2；1--固话，2--手机</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_start_time</td>
	<td style="width:132px;">进入系统时间</td>
	<td style="width:265px;">可选择UNIX时间戳，如：1367040082<br />
	或自定义格式，如：2013-04-27 13:21:22</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_answer_time</td>
	<td style="width:132px;">系统接听时间</td>
	<td style="width:265px;">格式同上</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_join_queue_time</td>
	<td style="width:132px;">进队列时间</td>
	<td style="width:265px;">格式同上</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_bridge_time</td>
	<td style="width:132px;">桥接时间，留言时用作留言开始时间</td>
	<td style="width:265px;">格式同上</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_end_time</td>
	<td style="width:132px;">挂机时间</td>
	<td style="width:265px;">格式同上</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_ivr_id</td>
	<td style="width:132px;">ivr id</td>
	<td style="width:265px;">系统中语音流程的编号</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_ivr_flow</td>
	<td style="width:132px;">该通话的ivr流程详情；每个节点使用逗号分隔，节点内各个参数段使竖线分隔。<br />
	定义：ivrId|nodeID|actionType|startTime|endTime</td>
	<td style="width:265px;">如：6|1|2|1367040083<br />
	当actionType为2时表示选择节点，为8时表示按收号节点；当进入这两种类型的节点后，本节点的vir流程会多两段数据，格式如下：<br />
	ivrId|nodeID|actionType|startTime|endTime|inputData|inputTime；如：<br />
	6|1|2|1367052344|1367052345|5|1367052345<br />
	表示，客户在2013-04-27 16:45:45进入选择节点后按下了&ldquo;5&rdquo;。</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_call_type</td>
	<td style="width:132px;">呼叫类型</td>
	<td style="width:265px;">1:呼入<br />
	2:web400呼入</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_status</td>
	<td style="width:132px;">通话状态</td>
	<td style="width:265px;">1:座席接听3:系统接听 4:系统未接ivr配置错误 5:系统未接-停机 6:系统未接-欠费 10:网上400未接受</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_mark</td>
	<td style="width:132px;">标识</td>
	<td style="width:265px;">1：留言<br />
	2：咨询<br />
	3：转移<br />
	7：交互</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_gw_ip</td>
	<td style="width:132px;">网关地址</td>
	<td style="width:265px;">网关IP；如：172.16.1.111</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_number_trunk</td>
	<td style="width:132px;">目的码</td>
	<td style="width:265px;">没有区号的8位号码，如：59222903</td>
	</tr>
	<tr>
	<td style="width:171px;height:46px;">cdr_bridged_cno</td>
	<td style="width:132px;height:46px;">呼入/呼出接听电话的座席编号</td>
	<td style="width:265px;height:46px;">如：2000</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_client_number</td>
	<td style="width:132px;">转接的电话号码</td>
	<td style="width:265px;">如座席号码、分机号真实号码等</td>
	</tr>
	<tr>
	<td style="width:171px;">cdr_record_file</td>
	<td style="width:132px;">录音文件名</td>
	<td style="width:265px;">可供企业提取录音文件，方法见下方</td>
	</tr>
	<tr>
	<td style="width:171px;">userField</td>
	<td style="width:132px;">自定义参数userField</td>
	<td style="width:265px;">企业可使用该参数在通话记录和挂机推送中记录需要的信息，可在外呼接口及语音流程中使用。</td>
	</tr>
</tbody>
</table>
<br />
自定义参数举例：&nbsp;<br />
<table align="left" border="0" cellpadding="0" cellspacing="0" width="426">
<tbody>
	<tr>
	<td style="width:171px;"><strong>参数名（仅供参考）</strong></td>
	<td style="width:397px;"><strong>描述</strong></td>
	</tr>
	<tr>
	<td style="width:171px;">pressKey</td>
	<td style="width:397px;">用户在语音流程中的按键反馈</td>
	</tr>
	<tr>
	<td style="width:171px;height:5px;">extnum</td>
	<td style="width:397px;height:5px;">用户在语音流程中输入的分机号</td>
	</tr>
	<tr>
	<td style="width:171px;height:5px;">signature</td>
	<td style="width:397px;height:5px;">按约定方式生成的签名</td>
	</tr>
	<tr>
	<td style="width:171px;height:5px;">&hellip;&hellip;</td>
	<td style="width:397px;height:5px;">&nbsp;</td>
	</tr>
</tbody>
</table>
<div style="clear:both;">&nbsp;</div>
&nbsp;<br />
<strong>返回值：</strong><br />
企业的接口应返回访问结果，否则视作交互失败，可能会反复推送信息。<br />
返回格式：JSON<br />
{&ldquo;result&rdquo;:&rdquo;返回结果&rdquo;}<br />
<table border="0" cellpadding="0" cellspacing="0" width="164">
<tbody>
	<tr>
	<td style="width:86px;height:27px;"><strong>返回结果</strong></td>
	<td style="width:133px;height:27px;"><strong>description</strong></td>
	</tr>
	<tr>
	<td style="width:86px;height:27px;">success</td>
	<td style="width:133px;height:27px;">CDR记录接收成功</td>
	</tr>
	<tr>
	<td style="width:86px;height:23px;">error</td>
	<td style="width:133px;height:23px;">CDR记录接收失败</td>
	</tr>
</tbody>
</table>
&nbsp;<br />
<strong>录音文件提取方式：</strong><br />
cdr_record_file记录的是对应通话的录音文件名，在有录音且大于五秒时产生。在文件名前补充http://InterfaceServerIp:port/voices/record/yyyymmdd(年月日)/，并在后面补充以下参数即可进行访问：<br />
<table border="0" cellpadding="0" cellspacing="0" width="423">
<tbody>
	<tr>
	<td style="width:98px;"><strong>参数</strong></td>
	<td style="width:44px;"><strong>要求</strong></td>
	<td style="width:99px;"><strong>描述</strong></td>
	<td style="width:323px;"><strong>备注</strong></td>
	</tr>
	<tr>
	<td style="width:98px;">hotline</td>
	<td style="width:44px;">可选</td>
	<td style="width:99px;">企业热线号码</td>
	<td style="width:323px;">与enterpriseId二选一</td>
	</tr>
	<tr>
	<td style="width:98px;">enterpriseId</td>
	<td style="width:44px;">可选</td>
	<td style="width:99px;">企业Id</td>
	<td style="width:323px;">与hotline二选一</td>
	</tr>
	<tr>
	<td style="width:98px;">userName</td>
	<td style="width:44px;">必选</td>
	<td style="width:99px;">用户名</td>
	<td style="width:323px;">登录后台用户名，如admin</td>
	</tr>
	<tr>
	<td style="width:98px;">pwd</td>
	<td style="width:44px;">必选</td>
	<td style="width:99px;">密码</td>
	<td style="width:323px;">对应username的密码，<strong>md5(md5(登录密码)seed)</strong>，例如：<br />
	密码为123456，seed为aaa<br />
	首先md5(123456)= e10adc3949ba59abbe56e057f20f883e<br />
	后接seed：e10adc3949ba59abbe56e057f20f883eaaa<br />
	再次加密：<br />
	md5(e10adc3949ba59abbe56e057f20f883eaaa)= d0782bdf141e366014b4bc0d7dc6ea00<br />
	即为应传入的pwd</td>
	</tr>
	<tr>
	<td style="width:98px;">seed</td>
	<td style="width:44px;">必选</td>
	<td style="width:99px;">自定字符串</td>
	<td style="width:323px;">&nbsp;</td>
	</tr>
</tbody>
</table>
<br />
</div>
    </div>
          
    
  </div>
  <div class="clear"></div>
</div>

<div class="footer">
    <div class="mcon posR"> 
        <p class="posA" style="left:0">COPYRIGHT © 2014 TI-NET. ALL RIGHTS RESERVED. 版权所有 北京天润融通科技股份有限公司</p>
        <p class="posA" style="right:0">呼叫中心运营许可证：B2-20070013 京ICP备06029233号 北京市公安局海淀分局备案号：1101085008</p>
    </div>
</div>

<div style="right:50px;" class="go2top"><a style="display: block;" href="#top" title="回到顶部"><span class="icon_m arrowup"></span></a></div>
</body>
</html>